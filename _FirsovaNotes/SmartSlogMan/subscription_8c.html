<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>API&nbsp;-&amp;nbspSmartSlog&nbsp;KP&nbsp;Library: subscription.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">API&nbsp;-&amp;nbspSmartSlog&nbsp;KP&nbsp;Library
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">subscription.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to work with the subscription.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="ss__func_8h_source.html">ss_func.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="classes_8h_source.html">classes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="structures_8h_source.html">structures.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="kpi__interface_8h_source.html">kpi_interface.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="repository_8h_source.html">repository.h</a>&quot;</code><br/>
<code>#include &quot;utils/kp_debug.h&quot;</code><br/>
<code>#include &quot;utils/util_func.h&quot;</code><br/>
<code>#include &quot;utils/check_func.h&quot;</code><br/>
<code>#include &quot;subscription_internal.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="subscription__changes__internal_8h_source.html">subscription_changes_internal.h</a>&quot;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> subscription_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#af736832209886c2db9c8aefd2fd3823d">sslog_new_subscription</a> (bool is_asynchronous)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new subscription.  <a href="#af736832209886c2db9c8aefd2fd3823d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a15e1ed8c90c6e71db28d3c80358049eb">sslog_free_subscription</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a subscription.  <a href="#a15e1ed8c90c6e71db28d3c80358049eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a0678560f42aa715007683e1ed2588936">sslog_sbcr_is_active</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks an active state of the subscription.  <a href="#a0678560f42aa715007683e1ed2588936"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#aab958bfdbab0140d0b7463de1851e961">sslog_sbcr_get_id</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a subscription identifier.  <a href="#aab958bfdbab0140d0b7463de1851e961"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> <br class="typebreak"/>
<a class="el" href="subscription__changes_8h.html#af0d4960f755fdcc8f46914de3f8e58c2">subscription_changes_data_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a2439185f6ca8bb77e85f914b76dd8fb9">sslog_sbcr_get_changes_last</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a subscription's last changes.  <a href="#a2439185f6ca8bb77e85f914b76dd8fb9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#aca8f934dc47f29b900f059a6daf5d2b7">sslog_sbcr_set_changed_handler</a> (subscription_t *subscription, void(*handler)(subscription_t *))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a handler that will be called after changing of subscribed data.  <a href="#aca8f934dc47f29b900f059a6daf5d2b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a8f0a6173aa6c76894fb8a5b7d6bfa9c8">sslog_sbcr_set_unsubscription_handler</a> (subscription_t *subscription, void(*handler)(subscription_t *))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets handler that will be called after receiving an unsubscription indication.  <a href="#a8f0a6173aa6c76894fb8a5b7d6bfa9c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a5c22e756a8c575ffd6ff425c57cac7b5">sslog_sbcr_add_individual</a> (subscription_t *subscription, individual_t *individual, list_t *properties)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a individual-properties pair to the subscription.  <a href="#a5c22e756a8c575ffd6ff425c57cac7b5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#aecff0558bceee64de184d59fb70d3c3b">sslog_sbcr_add_class</a> (subscription_t *subscription, class_t *ont_class)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a class to the subscription.  <a href="#aecff0558bceee64de184d59fb70d3c3b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a4c2fd152d9ca84514a2e2326fdb1219a">sslog_sbcr_subscribe</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribes a subscription.  <a href="#a4c2fd152d9ca84514a2e2326fdb1219a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a5ba4d73bd209836cc95dbc3a199e8eb3">sslog_sbcr_unsubscribe</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes a subscription.  <a href="#a5ba4d73bd209836cc95dbc3a199e8eb3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a1aad24d225baa9669fe1d28aade7d428">sslog_sbcr_unsubscribe_all</a> (bool with_free)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes all subscriptions (synchronous and asynchronous).  <a href="#a1aad24d225baa9669fe1d28aade7d428"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a82aad02fdc3d19b659492c30b2119d03">sslog_sbcr_wait</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits an indication for the subscription from the smart space.  <a href="#a82aad02fdc3d19b659492c30b2119d03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a73f61c6235ff363630906762add33ad1">sslog_sbcr_stop</a> (subscription_t *subscription)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates what checking of the subscription must be stopped.  <a href="#a73f61c6235ff363630906762add33ad1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="subscription_8c.html#a5568e34a9607a5fbc6b1d6d38feb6518">sslog_sbcr_stop_all</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates what synchronous checking of subscriptions must be stopped.  <a href="#a5568e34a9607a5fbc6b1d6d38feb6518"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Functions to work with the subscription. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Aleksandr A. Lomov &lt;<a href="mailto:lomov@cs.karelia.ru">lomov@cs.karelia.ru</a>&gt; </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>05 DEcember, 2009 </dd></dl>
<h2><a class="anchor" id="LICENSE"></a>
LICENSE</h2>
<p>SmartSlog KP Library is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>SmartSlog KP Library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with SmartSlog KP Library; if not, write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</p>
<h2><a class="anchor" id="DESCRIPTION"></a>
DESCRIPTION</h2>
<p><a class="el" href="subscription_8c.html" title="Functions to work with the subscription.">subscription.c</a> - <b>Functions to work with the subscribtion.</b> <br/>
 This file is part of SmartSlog KP Library.</p>
<p><b>Copyright (C) SmartSlog Team (Aleksandr A. Lomov). All rights reserved.</b> <br/>
 Mail-list: <a href="mailto:smartslog@cs.karelia.ru">smartslog@cs.karelia.ru</a> </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a15e1ed8c90c6e71db28d3c80358049eb"></a><!-- doxytag: member="subscription.c::sslog_free_subscription" ref="a15e1ed8c90c6e71db28d3c80358049eb" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#a15e1ed8c90c6e71db28d3c80358049eb">sslog_free_subscription</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free a subscription. </p>
<p>This function does't release active subscriptions.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription container for free. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af736832209886c2db9c8aefd2fd3823d"></a><!-- doxytag: member="subscription.c::sslog_new_subscription" ref="af736832209886c2db9c8aefd2fd3823d" args="(bool is_asynchronous)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> subscription_t* <a class="el" href="subscription_8c.html#af736832209886c2db9c8aefd2fd3823d">sslog_new_subscription</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_asynchronous</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates a new subscription. </p>
<p>The subscriptioon can be synhronous or asynchronous. In the first case you need to call #sbcr_wait to start checking notification from the smart space. In the second case, all operations are made in the background thread.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">is_asynchronous</td><td>flag of the asynchronous type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>new created subscription on success or NULL otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="aecff0558bceee64de184d59fb70d3c3b"></a><!-- doxytag: member="subscription.c::sslog_sbcr_add_class" ref="aecff0558bceee64de184d59fb70d3c3b" args="(subscription_t *subscription, class_t *ont_class)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int <a class="el" href="subscription_8c.html#aecff0558bceee64de184d59fb70d3c3b">sslog_sbcr_add_class</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class_t *&#160;</td>
          <td class="paramname"><em>ont_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a class to the subscription. </p>
<p>You can subscribe to the class of individuals. This means that you will get notifications evry time when RDF-triple that describes a type of an individual (uuid - rdf:type - classtype) will be inseted or removed to/from the smart space. New individuals will be created automatically using indication data, but the subscripton doesn't remove individuals when they are removed from the smart space.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to add new data for subscribing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ont_class</td><td>class to add.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SSLOG_ERROR_NO on success or error code otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a5c22e756a8c575ffd6ff425c57cac7b5"></a><!-- doxytag: member="subscription.c::sslog_sbcr_add_individual" ref="a5c22e756a8c575ffd6ff425c57cac7b5" args="(subscription_t *subscription, individual_t *individual, list_t *properties)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int <a class="el" href="subscription_8c.html#a5c22e756a8c575ffd6ff425c57cac7b5">sslog_sbcr_add_individual</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">individual_t *&#160;</td>
          <td class="paramname"><em>individual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list_t *&#160;</td>
          <td class="paramname"><em>properties</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a individual-properties pair to the subscription. </p>
<p>You can subscribe to properties of the individual. To make this subscription you need the individual and a list with properties. You can add many pairs to the one subscription. <br/>
 If you pass NULL instead the properties list, then all properties of the individual's parent class will be used for subscribing.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to add new data for subscribing. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">individual</td><td>individual to add. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">properties</td><td>list of properties to subscribe or NULL for all properties.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SSLOG_ERROR_NO on success or error code otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a2439185f6ca8bb77e85f914b76dd8fb9"></a><!-- doxytag: member="subscription.c::sslog_sbcr_get_changes_last" ref="a2439185f6ca8bb77e85f914b76dd8fb9" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> <a class="el" href="subscription__changes_8h.html#af0d4960f755fdcc8f46914de3f8e58c2">subscription_changes_data_t</a>* <a class="el" href="subscription_8c.html#a2439185f6ca8bb77e85f914b76dd8fb9">sslog_sbcr_get_changes_last</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets a subscription's last changes. </p>
<p>When subscribed data are changed, then information about last changes is updated. You can use this information to track what data have been chenged after last notification.</p>
<p><b>Be careful using the asynchronous subscription</b>.<br/>
 If you get the changes not in the handler, then it possible what they will be freed if the new notification for current subscription will be received while you are working with them. <br/>
 It's better to make a copy of data or make all needed actions with changes in the handler.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to get last changes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>information about last changes on success or NULL otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="aab958bfdbab0140d0b7463de1851e961"></a><!-- doxytag: member="subscription.c::sslog_sbcr_get_id" ref="aab958bfdbab0140d0b7463de1851e961" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> const char* <a class="el" href="subscription_8c.html#aab958bfdbab0140d0b7463de1851e961">sslog_sbcr_get_id</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets a subscription identifier. </p>
<p>When subscription is in active state (it is subscribed), then it has an identifier. While subscription is in inactive state, then the identifier is empty string.<br/>
 <b>Don't free or modify returned string.</b></p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to get the indentifier.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Subscription identifier or NULL if function can't perfome operation. </dd></dl>

</div>
</div>
<a class="anchor" id="a0678560f42aa715007683e1ed2588936"></a><!-- doxytag: member="subscription.c::sslog_sbcr_is_active" ref="a0678560f42aa715007683e1ed2588936" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> bool <a class="el" href="subscription_8c.html#a0678560f42aa715007683e1ed2588936">sslog_sbcr_is_active</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks an active state of the subscription. </p>
<p>Subscription is active, when it was successfully subscribed. You can't change type of the subscription (synchronous or asynchronous) or add entities to the subcription when it has active state. When you unsubscribe the subscription or from the smart space receives unsubscribe indication, then the subscription changes the state to inactive.</p>
<p>This function set global error if it can't perfome operation, you can get a error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subcription to check the state.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the subscription has active state or false otherwise (also if argument is incorrect). </dd></dl>

</div>
</div>
<a class="anchor" id="aca8f934dc47f29b900f059a6daf5d2b7"></a><!-- doxytag: member="subscription.c::sslog_sbcr_set_changed_handler" ref="aca8f934dc47f29b900f059a6daf5d2b7" args="(subscription_t *subscription, void(*handler)(subscription_t *))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#aca8f934dc47f29b900f059a6daf5d2b7">sslog_sbcr_set_changed_handler</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(subscription_t *)&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets a handler that will be called after changing of subscribed data. </p>
<p>Subscribed data could be changed after indications, after updating local data this handler will be called. You can get last changes using #sbcr_get_last_changes.</p>
<p>You can't change the handler when the subscription is active.</p>
<p>The handler is called synchronously. It is important for asynchronous subscription, because the calling of the handler stops checking indications for other subscription.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to set handler. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>pointer to hadler or NULL to reset/disable it. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8f0a6173aa6c76894fb8a5b7d6bfa9c8"></a><!-- doxytag: member="subscription.c::sslog_sbcr_set_unsubscription_handler" ref="a8f0a6173aa6c76894fb8a5b7d6bfa9c8" args="(subscription_t *subscription, void(*handler)(subscription_t *))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#a8f0a6173aa6c76894fb8a5b7d6bfa9c8">sslog_sbcr_set_unsubscription_handler</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(subscription_t *)&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets handler that will be called after receiving an unsubscription indication. </p>
<p>The smart space can unsubscribe a subscription. It sends the unsubscription indication to an agent, after receiving this indication and processed it this hendler will be called.</p>
<p>The state of the subscription changes to inactive after unsubscribing indication and you can subscribe it again.</p>
<p>This handler did not called if you unsubscribe the subscription by youself with function #sbcr_unsubscribe.</p>
<p>The handler is called synchronously. It is important for asynchronous subscription, because the calling of the handler stops checking indications for other subscription.</p>
<p>You can't change the handler when the subscription is active.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to set handler. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>pointer to hadler or NULL to reset/disable it. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a73f61c6235ff363630906762add33ad1"></a><!-- doxytag: member="subscription.c::sslog_sbcr_stop" ref="a73f61c6235ff363630906762add33ad1" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#a73f61c6235ff363630906762add33ad1">sslog_sbcr_stop</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indicates what checking of the subscription must be stopped. </p>
<p>This function works in pair with #sbcr_wait and works only with synchronous subscriptions.<br/>
 If you want to stop waiting, then you call this function. It only indicates, but not really stops checking, you need to wait while the #sbcr_wait ends, and then make other actions under subscription.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to stop. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5568e34a9607a5fbc6b1d6d38feb6518"></a><!-- doxytag: member="subscription.c::sslog_sbcr_stop_all" ref="a5568e34a9607a5fbc6b1d6d38feb6518" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#a5568e34a9607a5fbc6b1d6d38feb6518">sslog_sbcr_stop_all</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indicates what synchronous checking of subscriptions must be stopped. </p>
<p>This function works in pair with #sbcr_wait and it is similar with #sbcr_stop but indicates stop checking for all synchrnous subscriptions.</p>
<p>If you want to stop waiting, then you call this function. It only indicates, but not really stops checking, you need to wait while the #sbcr_wait ends, and then make other actions under subscriptions.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function. </p>

</div>
</div>
<a class="anchor" id="a4c2fd152d9ca84514a2e2326fdb1219a"></a><!-- doxytag: member="subscription.c::sslog_sbcr_subscribe" ref="a4c2fd152d9ca84514a2e2326fdb1219a" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int <a class="el" href="subscription_8c.html#a4c2fd152d9ca84514a2e2326fdb1219a">sslog_sbcr_subscribe</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Subscribes a subscription. </p>
<p>On success, the subscription changes status to active. After this you can't change the subscription: add new data for subscribing, change a type (synchronous or asynchronous) and etc. Also this function performs a first synchronization: the smart space sends all data that are corresponds to subscribed data. This data is used to set a starting state of the local data to track further changes.</p>
<p>To start checking notification from the smart space for the synchronous subscription you need to call the #sbcr_wait function.</p>
<p>You can track local data chnages using callback function. This callback will be called evry time then local data is changed. Use #sbcr_set_changed_handler function to set this callback.</p>
<p>You can manually unsubscribe the subscription using #sbcr_unsubscribe function, but sometimes the smart space can unsubscribe it. In this case will be called the unsubscription callback. Use #sbcr_set_unsubscription_handler function to set this callback.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to subscribe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SSLOG_ERROR_NO on seccess or error code otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a5ba4d73bd209836cc95dbc3a199e8eb3"></a><!-- doxytag: member="subscription.c::sslog_sbcr_unsubscribe" ref="a5ba4d73bd209836cc95dbc3a199e8eb3" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int <a class="el" href="subscription_8c.html#a5ba4d73bd209836cc95dbc3a199e8eb3">sslog_sbcr_unsubscribe</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unsubscribes a subscription. </p>
<p>The function sends a unsubscribe message to the smart space and waits a unsubscribing confirmation from the smart space. This operation may take some time if a link with the smart space is bad or the smart space doesn't send the confirmation message. If the confirmation message is received or a timeout is ended, then the subscription is considered as unsubscribed and it's status is changed to inactive.</p>
<p>It is possible that before the unsubscription message will be received one or more indications, this indications will be handled as usual: with updating local data and with calling handlers.</p>
<p><b>Remember: </b> if you unsubscribe from the subscription, then you need to free it by yourself using #free_subscription if it does not needed.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to unsubscribe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SSLOG_ERROR_NO on seccess or error code otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a1aad24d225baa9669fe1d28aade7d428"></a><!-- doxytag: member="subscription.c::sslog_sbcr_unsubscribe_all" ref="a1aad24d225baa9669fe1d28aade7d428" args="(bool with_free)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> void <a class="el" href="subscription_8c.html#a1aad24d225baa9669fe1d28aade7d428">sslog_sbcr_unsubscribe_all</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>with_free</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unsubscribes all subscriptions (synchronous and asynchronous). </p>
<p>This function is similar to #sbcr_unsubscribe, but works with all subscriptions and can free subscriptions while working.</p>
<p><b>Remembe:</b> if you pass flag to the function as 'true', then you do not need to 'free' subscription by youself. Also do not use this function if you are waiting synchronous subscription with #sbcr_wait function. You need to stop (<a class="el" href="subscription_8c.html#a73f61c6235ff363630906762add33ad1" title="Indicates what checking of the subscription must be stopped.">sslog_sbcr_stop</a>) synchronous sybscription before calling this function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">with_free</td><td>flag to indicate a need to free subscriptions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a82aad02fdc3d19b659492c30b2119d03"></a><!-- doxytag: member="subscription.c::sslog_sbcr_wait" ref="a82aad02fdc3d19b659492c30b2119d03" args="(subscription_t *subscription)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kp__error_8h.html#ad4ffac3b9741d653777f598ee797e0e3">SSLOG_EXTERN</a> int <a class="el" href="subscription_8c.html#a82aad02fdc3d19b659492c30b2119d03">sslog_sbcr_wait</a> </td>
          <td>(</td>
          <td class="paramtype">subscription_t *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Waits an indication for the subscription from the smart space. </p>
<p>This function works only with synchronous subscriptions. It checks is there any notifications from the smart space for the current subscription. If the notification is received then it updates subscribed data and ends.</p>
<p>If the smart space sends a unsubscription message, then it changes the subscription state to inactive and ends.</p>
<p>With synchronous subscription you also can use callbacks function to track the changing subscribed data and the unsubscription.</p>
<p>To stop waiting you can use #sbcr_stop function.</p>
<p><b>Remember:</b> do not use #sbcr_unsubscribe or #sbcr_unsubscribe_all functions while you are waiting. Call the #sbcr_stop function and when the #sbcr_wait ends working, then you can unsubscribe subscription.</p>
<p>This function sets a global error if it can't perfome operation, you can get an error code using <a class="el" href="kp__error_8h.html#a4633dd6eee4f462ff3066f55a0258370" title="Return code of error.">sslog_get_error_code</a> function.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">subscription</td><td>subscription to wait notifications.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SSLOG_ERROR_NO on seccess (notification, unsubscribe message is received or subscription was stopped with <a class="el" href="subscription_8c.html#a73f61c6235ff363630906762add33ad1" title="Indicates what checking of the subscription must be stopped.">sslog_sbcr_stop</a>) or error code otherwise. </dd></dl>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 26 2013 18:00:04 for API&nbsp;-&nbspSmartSlog&nbsp;KP&nbsp;Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
